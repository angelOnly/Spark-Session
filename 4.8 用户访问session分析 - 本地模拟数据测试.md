## 4.8 用户访问session分析 - 本地模拟数据测试
基于前面的代码实现逻辑，借助 4.1 生成的模拟数据，实现用户Session的数据统计

#### session_detail

##### 总数量

````sql
mysql> select count(*) from session_detail;
+----------+
| count(*) |
+----------+
|    23000 |
+----------+
1 row in set (0.01 sec)
````

##### 部分结果 

````sql
select * from session_detail;
+---------+---------+----------------------------------+---------+---------------------+--------------------+-------------------+------------------+--------------------+--------------------+------------------+-----------------+
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       4 | 2018-06-22 19:24:02 | NULL               |                 0 |                0 | 5                  | 41                 |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       8 | 2018-06-22 19:15:58 | NULL               |                45 |               96 | NULL               | NULL               |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       5 | 2018-06-22 19:23:57 | NULL               |                 0 |                0 | 61                 | 85                 |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       3 | 2018-06-22 19:21:17 | NULL               |                 0 |                0 | NULL               | NULL               |               38 | 35              |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       1 | 2018-06-22 19:41:39 | NULL               |                 0 |                0 | NULL               | NULL               |               31 | 3               |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       7 | 2018-06-22 19:42:02 | NULL               |                 0 |                0 | NULL               | NULL               |               81 | 91              |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       9 | 2018-06-22 19:06:10 | NULL               |                 0 |                0 | 66                 | 18                 |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       0 | 2018-06-22 19:24:22 | NULL               |                 0 |                0 | 52                 | 82                 |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       6 | 2018-06-22 19:22:50 | NULL               |                 0 |                0 | NULL               | NULL               |               89 | 7               |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       0 | 2018-06-22 19:48:15 | NULL               |                 0 |                0 | 49                 | 56                 |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       6 | 2018-06-22 19:28:02 | NULL               |                 0 |                0 | 44                 | 61                 |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       5 | 2018-06-22 19:12:19 | NULL               |                 0 |                0 | 82                 | 93                 |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       0 | 2018-06-22 19:28:16 | NULL               |                20 |               92 | NULL               | NULL               |             NULL | NULL            |
|       1 |      80 | 8353a57395494f1b95ec152f76c32882 |       1 | 2018-06-22 19:10:52 | NULL               |                 0 |                0 | NULL               | NULL               |               69 | 14              |
+---------+---------+----------------------------------+---------+---------------------+--------------------+-------------------+------------------+--------------------+--------------------+------------------+-----------------+
23000 row in set (0.03 sec)
````

#### user_info

##### 总数量

````sql
mysql> select count(*) from user_info;
+----------+
| count(*) |
+----------+
|      200 |
+----------+
1 row in set (0.00 sec)
````

##### 部分运行结果

````sql
mysql> select * from user_info;
+---------+-----------+--------+------+----------------+--------+--------+
| user_id | user_name | name   | age  | professional   | city   | sex    |
+---------+-----------+--------+------+----------------+--------+--------+
|       0 | user0     | name0  |   45 | professional7  | city63 | male   |
|       1 | user1     | name1  |   22 | professional7  | city64 | female |
|       2 | user2     | name2  |   40 | professional14 | city79 | male   |
|       3 | user3     | name3  |   11 | professional16 | city35 | male   |
|       4 | user4     | name4  |   20 | professional33 | city54 | male   |
|       5 | user5     | name5  |    5 | professional12 | city99 | female |
|       6 | user6     | name6  |   49 | professional87 | city76 | female |
|       7 | user7     | name7  |   18 | professional18 | city18 | female |
|       8 | user8     | name8  |   40 | professional29 | city15 | male   |
|       9 | user9     | name9  |   11 | professional69 | city43 | male   |
+---------+-----------+--------+------+----------------+--------+--------+
200 rows in set (0.00 sec)
````

#### task

````sql
mysql> select * from task;
+----+-----------+-------------+------------+-------------+-----------+-------------+---------------------------------------------------------------------------------------+
| id | name      | create_time | start_time | finish_time | task_type | task_status | task_param                                                                            |
+----+-----------+-------------+------------+-------------+-----------+-------------+---------------------------------------------------------------------------------------+
|  1 | test_task | NULL        | NULL       | NULL        | task      | 0           | {'startAge':['10'],'endAge':['50'],'startDate':['2019-1-10'],'endDate':['2019-1-30']} |
+----+-----------+-------------+------------+-------------+-----------+-------------+---------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
````

#### session_aggr_stat

````sql
mysql> select * from session_aggr_stat;
+---------+---------------+-------+-------+-------+---------+---------+-------+--------+---------+------+------+------+------+-------+-------+------+
| task_id | session_count | 1s_3s | 4s_6s | 7s_9s | 10s_30s | 30s_60s | 1m_3m | 3m_10m | 10m_30m | 30m  | 1_3  | 4_6  | 7_9  | 10_30 | 30_60 | 60   |
+---------+---------------+-------+-------+-------+---------+---------+-------+--------+---------+------+------+------+------+-------+-------+------+
|       1 |            40 |     0 |     0 |     0 |       0 |       0 |     0 |      0 |    0.07 | 0.88 | 0.05 | 0.17 | 0.17 |  0.57 |     0 |    0 |
+---------+---------------+-------+-------+-------+---------+---------+-------+--------+---------+------+------+------+------+-------+-------+------+
1 row in set (0.02 sec)
````

#### session_random_extract

##### 总数量

````sql
mysql> select count(*) from session_random_extract;
+----------+
| count(*) |
+----------+
|       13 |
+----------+
1 row in set (0.00 sec)
````

##### 部分运行结果

````sql
mysql> select * from session_random_extract;
+---------+----------------------------------+---------------------+----------------------------------------+--------------------+
| task_id | session_id                       | start_time          | search_keywords                        | click_category_ids |
+---------+----------------------------------+---------------------+----------------------------------------+--------------------+
|       1 | d3170f351eab4e98b09d73dbd8791275 | 2018-06-22 21:06:51 | 蛋糕,新辣道鱼火锅                      | 0,24,94,49,74      |
|       1 | fee77b7611d047b1a3a866f09fd89dd2 | 2018-06-22 17:00:18 | 日本料理,温泉                          | 0,84               |
|       1 | 034d46665b5b4640bc96b8afa045d1c6 | 2018-06-22 18:00:13 | 国贸大厦,新辣道鱼火锅,蛋糕             | 0,45,80            |
|       1 | f323fc6ca0914857a4a5ec92a6b7d88b | 2018-06-22 10:12:22 | 呷哺呷哺,温泉                          | 0,98               |
|       1 | d5c47f07f70140bb8659e2d91ff20584 | 2018-06-22 19:01:46 | 新辣道鱼火锅,重庆辣子鸡                | 0,98               |
|       1 | d80ba06474904450bb7e145feff4c349 | 2018-06-22 04:17:53 | 蛋糕,火锅                              | 0                  |
|       1 | 5f1396dbd1c444cc9564dae1782b3c34 | 2018-06-22 08:33:10 | 重庆辣子鸡,新辣道鱼火锅                | 0,50,96,92         |
|       1 | 73de732b763a45e780a77e6c3d9b4b19 | 2018-06-22 22:06:03 | 重庆辣子鸡,蛋糕                        | 0                  |
|       1 | e0dd19fcb8c14da783f592f8b1c8eb4e | 2018-06-22 16:02:41 | 温泉,蛋糕,日本料理                     | 0,68,36,70         |
|       1 | 4cc7856da2ed4381a02ff78d5bbf32f2 | 2018-06-22 15:08:05 | NULL                                   | 0,94,77,21         |
|       1 | 2b91c66827e34d5a99fb11903eba573f | 2018-06-22 12:01:40 | NULL                                   | 0,75,77            |
|       1 | f2f96f56fb944a33a13573bf2622f4e6 | 2018-06-22 02:03:24 | 火锅,太古商场,呷哺呷哺                 | 0                  |
|       1 | 94bfc79d9c204117b17cabb69e04aaff | 2018-06-22 01:02:13 | 重庆辣子鸡,火锅,蛋糕                   | 8,0,69             |
+---------+----------------------------------+---------------------+----------------------------------------+--------------------+
13 rows in set (0.00 sec)
````

#### user_visit_action

##### 总数量

````sql
mysql> select count(*) from user_visit_action;
+----------+
| count(*) |
+----------+
|    22416 |
+----------+
1 row in set (0.01 sec)
````

##### 部分运行结果

````sql
mysql> select * from user_visit_action;
+---------+---------------+-------+-------+-------+---------+---------+-------+--------+---------+------+------+------+------+-------+-------+------+
| 2018-06-22 |      61 | 137fef3066b34d2eba26364c9c6a7e86 |       2 | 2018-06-22 11:56:14 | 新辣道鱼火锅       |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | 137fef3066b34d2eba26364c9c6a7e86 |       9 | 2018-06-22 11:03:23 | 太古商场           |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | 137fef3066b34d2eba26364c9c6a7e86 |       3 | 2018-06-22 11:04:02 | 重庆辣子鸡         |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | 137fef3066b34d2eba26364c9c6a7e86 |       2 | 2018-06-22 11:25:14 | NULL               |                 0 |                0 | NULL               | NULL              | 49               | 1               |
| 2018-06-22 |      61 | 137fef3066b34d2eba26364c9c6a7e86 |       5 | 2018-06-22 11:00:39 | NULL               |                 7 |                7 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | 137fef3066b34d2eba26364c9c6a7e86 |       7 | 2018-06-22 11:28:27 | 重庆辣子鸡         |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | 137fef3066b34d2eba26364c9c6a7e86 |       2 | 2018-06-22 11:31:07 | 日本料理           |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | e0a59846b97545469f9bfdb75e6a9130 |       5 | 2018-06-22 0:09:15  | NULL               |                 0 |                0 | 28                 | 71                | NULL             | NULL            |
| 2018-06-22 |      61 | e0a59846b97545469f9bfdb75e6a9130 |       9 | 2018-06-22 0:39:26  | 日本料理           |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | e0a59846b97545469f9bfdb75e6a9130 |       8 | 2018-06-22 0:42:52  | 太古商场           |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | e0a59846b97545469f9bfdb75e6a9130 |       0 | 2018-06-22 0:27:19  | 呷哺呷哺           |                 0 |                0 | NULL               | NULL              | NULL             | NULL            |
| 2018-06-22 |      61 | e0a59846b97545469f9bfdb75e6a9130 |       5 | 2018-06-22 0:17:29  | 呷哺呷哺           |                 0 |                0 | NULL               | NULL     
+------------+---------+----------------------------------+---------+---------------------+--------------------+-------------------+------------------+--------------------+-------------------+------------------+-----------------+
22416 rows in set (0.04 sec)
````

