## 5.1 top10 热门品类实现思路
通过筛选的session，包括用户访问的所有品类(点击，下单，支付)，按照各个品类的点击，下单和支付次数降序排序，获取前10个品类。

#### 降序排序

首先按照**点击次数**排序，如果点击次数相等，按照**下单次数**排序。如果下单次数相等，按照**支付次数**排序。

#### 实现思路

1. 获取到筛选条件下的session访问过的所有品类Id

2. 计算出session访问过的所有品类的点击，下单和支付次数，这里可能要和第一步计算出来的品类进行join

3. 自己开发二次排序的key

   如果只是根据某一个字段进行排序，就不是二次排序

   **二次排序：** 根据不止一个字段排序，可能根据多个字段进行多次排序

   **sortByKey：** 默认情况下，支持根据int，long等类型进行排序，但是那样的话，key只能有一个字段

   这里有三个字段，所以需要自定义 key 作为 sortByKey 的key。**自定义key** 中封装n个段，并在key的指定接口方法中实现自己的根据多字段的排序算法。

   然后再使用 sortByKey 算子进行排序，那么就可以按照自己的key，使用多个字段进行排序。

4. 做映射，将品类的点击，下单和支付次数，封装到二次排序key中，作为pairRDD的key

5. 使用sortByKey(false)按照自定义key进行降序二次排序

6. 使用take(10)获取排序后的前10个品类就是top10热门品类

7. 将top10热门品类，以及每个品类的点击，下单和支付次数，写入MySQL数据库

8. 本地测试